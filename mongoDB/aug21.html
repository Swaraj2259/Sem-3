<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-database-compat.js"></script>


</head>

<body>
    <h1>Welcome to Dashboard ðŸŽ‰</h1>


    <script type="module">
        const firebaseConfig = {
            apiKey: "AIzaSyDo8kMMen-pFs7-meRa6Ue2rcnbTE5xOtM",
            authDomain: "classwork-81321.firebaseapp.com",
            projectId: "classwork-81321",
            storageBucket: "classwork-81321.firebasestorage.app",
            messagingSenderId: "354105108326",
            appId: "1:354105108326:web:48e360415142ed20580aa7",
            measurementId: "G-HGCWJJ5HPE",
            databaseURL: "https://classwork-81321-default-rtdb.asia-southeast1.firebasedatabase.app"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();


        //real time -> ref,set,delete,

        async function insertData(collectionName, docId, name, age, gender) {
            try {

                const data ={ name, age, gender};

                let result = firebase
                    .database()
                    .ref(`${collectionName}/${docId}`)
                 
                await result.set(data);
                    console.log(`data added ${data}`)
               

            }
            catch (e) {
                console.log(`Something went wrong: ${e}`);
            }
        }

        async function deleteData(collectionName, docId) {
            try {
                let result = firebase
                    .database()
                    .ref(`${collectionName}/${docId}`).remove();
                
            }
            catch (e) {
                console.log(`Something went wrong: ${e}`);
            }
        }

       function deleteAllData(collectionName) {
            try {
                let result = firebase
                    .database()
                    .ref(`${collectionName}`).remove();
                console.log(`All data deleted    from ${collectionName}`);
            }
            catch (e) {
                console.log(`Something went wrong: ${e}`);
            }
        } 


        function updateData(collectionName, docId){
            firebase
        }



        //todo : read using get function

        async function getallDocument(collectionName){
            try{

                let snapshot = await firebase
                .database()
                .ref(`${collectionName}`)
                .get();
                if (snapshot.exists()){
                    snapshot.forEach((doc)=>{
                        console.log(doc.val());
                    });
                }

            }
            catch(e){
                console.log(`Something went wrong: ${e}`);
            } 
        }
 
        async function getDataOnce(collectionName, docId) {
    try {
        let snapshot = await firebase
            .database()
            .ref(`${collectionName}/${docId}`)
            .once("value");   // returns a promise

        if (snapshot.exists()) {
            console.log(snapshot.val());
            return snapshot.val();
        } else {
            console.log(`No data found for ${docId}`);
            return null;
        }
    } catch (e) {
        console.error(`Something went wrong: ${e}`);
    }
}


        window.api={insertData, deleteData, deleteAllData, getallDocument, getDataOnce};
    </script>
</body>

</html>